# Frontend v1.2.0 Design — Config-First UX Refresh

**Date:** 2026-02-18
**Branch:** `frontend-refresh`
**Scope:** Phase 1 frontend improvements targeting the highest-value usability gains.

---

## Context

The ium web UI is primarily used in a **config-focused** pattern: users open it to add/edit image configurations, occasionally check update status, and rarely watch it actively. The top pain point is the config workflow. All changes are vanilla JS/CSS with no build process.

---

## Feature Summary

### 1. Dark Mode

**Implementation:** CSS custom properties already in use. Add a `[data-theme="dark"]` attribute on `<html>` with overriding variable values. System preference (`prefers-color-scheme: dark`) is the default; users can override with a toggle button in the header. Preference persisted in `localStorage`.

**Dark palette:**
- `--background: #121212`
- `--surface: #1e1e1e`
- `--border: #333333`
- `--text-primary: #e0e0e0`
- `--text-secondary: #9e9e9e`
- `--primary-color: #42a5f5` (lighter blue for dark contrast)

**Toggle:** Small icon button in the header status bar (CSS sun/moon symbol, no emoji). Clicking cycles light → dark → system.

---

### 2. Log Tab + Navigation Cleanup

**Changes:**
- Activity Log moves from a permanent bottom section to a **4th tab**: Updates | Configuration | History | **Log**
- The `#log-output` element lives inside the Log tab pane; Socket.IO continues appending to it regardless of active tab
- **Unread badge:** When a log line is added while the Log tab is not active, a numeric badge appears on the "Log" tab button. Resets to 0 when the tab is opened
- **Refresh Config button removed** from the controls bar (redundant: config auto-reloads after save)
- Controls bar becomes: **Check Now | Start/Stop Daemon | [Interval input]**

---

### 3. Updates Tab — Apply Update Action

**Update cards become richer and actionable:**
- Show: image name, container name (if known), `old_tag → new_tag` with visual arrow, digest (first 12 chars)
- **Apply Update button** per card (no confirmation modal — the button itself is sufficient)
  - On click: button shows spinner, becomes disabled
  - On success: card animates to "Applied" state (green left-border, checkmark, button disabled)
  - On error: inline error text appears on the card
- If `auto_update` is enabled for that image: Apply button is replaced with an "Auto-update enabled" badge

**New backend endpoint:** `POST /api/apply-update`
- Accepts `{ "image": "...", "new_tag": "..." }`
- Calls existing updater logic to apply the specific update
- Returns `{ "success": true }` or `{ "error": "..." }`

---

### 4. Config Workflow Improvements

**A. Unsaved changes indicator**
- When any Config tab field changes, a sticky amber banner appears at the top of the Config tab pane: *"You have unsaved changes"* with a **Save Now** button
- The existing "Save Configuration" toolbar button also pulses/emphasizes when dirty
- After successful save: banner disappears, green toast notification fades in

**B. New cards start expanded**
- `+ Add Image` and `Add from Preset` now produce expanded cards immediately
- No second click required to see fields

**C. Empty state**
- When no images are configured, show a centered call-to-action with `+ Add Image` and `Add from Preset` buttons, instead of the CSS `::after` pseudo-element text

**D. "Suggest Pattern" rename + auto-detect improvement**
- Button renamed from "Detect Patterns" → **"Suggest Pattern"** (less technical)
- On `blur` of the image name field (if regex is empty), detection triggers automatically with a subtle inline "Detecting..." indicator
- If a single high-confidence pattern is found, it is auto-selected into the regex field
- The "Suggest Pattern" button remains for manual re-runs

**E. Toast notifications**
- After save: brief toast in bottom-right corner (3-second fade-out), green = success, red = error
- Toast replaces the log-only feedback; the log entry is still written but the toast is the primary user-facing signal

---

## What is NOT in scope for v1.2.0 Phase 1

- Sidebar navigation or layout restructuring
- New color palette / visual rebrand
- History tab improvements
- Notifications tab changes
- Mobile-specific redesign beyond existing responsive CSS

---

## Files Affected

| File | Changes |
|------|---------|
| `static/css/style.css` | Dark mode variables, toast styles, unsaved banner, empty state, tab badge, Apply button states |
| `static/js/app.js` | Dark mode toggle/persistence, log tab + badge logic, Apply Update flow, unsaved-changes tracking, toast function, Suggest Pattern rename + auto-detect, empty state rendering |
| `templates/index.html` | Log tab added to tab strip, log section removed from bottom, controls bar simplified |
| `webui.py` | New `POST /api/apply-update` endpoint |
