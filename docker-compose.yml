services:
  dum:
    build:
      context: .
      dockerfile: Dockerfile.webui
    image: dum:latest
    container_name: dum
    restart: unless-stopped
    ports:
      - "5050:5050"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ./config:/config
      - ./state:/state
    environment:
      - LOG_LEVEL=INFO
      # - WEBUI_USER=admin
      # - WEBUI_PASSWORD=changeme
    networks:
      - dum-net

  dum-cli:
    build: .
    image: dum-cli:latest
    container_name: dum-cli
    restart: unless-stopped
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ./config:/config
      - ./state:/state
    environment:
      - LOG_LEVEL=INFO
    networks:
      - dum-net
    profiles:
      - cli

networks:
  dum-net:
    driver: bridge

# Usage:
# 1. Web UI (default): docker-compose up -d
# 2. CLI daemon only: docker-compose --profile cli up -d dum-cli
# 3. Both: docker-compose --profile cli up -d
