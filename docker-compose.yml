services:
  ium:
    build:
      context: .
      dockerfile: Dockerfile.webui
    image: brendanl79/ium:latest
    container_name: ium
    restart: unless-stopped
    ports:
      - "5050:5050"
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ./config:/config
      - ./state:/state
    environment:
      - LOG_LEVEL=INFO
      - TZ=UTC
      # Authentication: credentials are auto-generated on first run and stored in
      # /state/.auth.json. Check container logs for the generated username/password.
      # To set fixed credentials instead, uncomment and set these env vars:
      # - WEBUI_USER=admin
      # - WEBUI_PASSWORD=changeme
    networks:
      - ium-net

  ium-cli:
    build: .
    image: brendanl79/ium-cli:latest
    container_name: ium-cli
    restart: unless-stopped
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - ./config:/config
      - ./state:/state
    environment:
      - LOG_LEVEL=INFO
      - TZ=UTC
    networks:
      - ium-net
    profiles:
      - cli

networks:
  ium-net:
    driver: bridge

# Usage:
# 1. Web UI (default): docker-compose up -d
# 2. CLI daemon only: docker-compose --profile cli up -d ium-cli
# 3. Both: docker-compose --profile cli up -d
